<!DOCTYPE html>
<html lang="en">

<head>
  <%- include("./partials/head") %>
    <title>New Story - Blogify</title>
</head>

<body>
  <div class="app-container">
    <%- include("./partials/nav") %>

      <main class="main-content">
        <div class="form-container" style="max-width: 700px; margin: 0 auto;">
          <div class="form-card" style="padding: var(--space-10);">
            <!-- Header -->
            <div class="form-header">
              <h1 class="form-title" style="font-size: var(--text-4xl);">Tell your story</h1>
              <p class="form-subtitle">Share your thoughts with the world</p>
            </div>

            <!-- Form -->
            <form action="/blog" method="post" enctype="multipart/form-data">
              <!-- Cover Image Upload -->
              <div class="form-group">
                <label class="form-label">Cover Image</label>
                <div class="file-upload" id="fileUpload">
                  <input type="file" class="file-upload-input" id="coverImage" name="coverImage" accept="image/*"
                    required />
                  <svg class="file-upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="1.5">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21,15 16,10 5,21"></polyline>
                  </svg>
                  <p class="file-upload-text">
                    <strong>Click to upload</strong> or drag and drop<br>
                    <span style="font-size: var(--text-xs); color: var(--color-text-muted);">PNG, JPG up to 10MB</span>
                  </p>
                </div>
                <div id="imagePreview"
                  style="display: none; margin-top: var(--space-4); border-radius: var(--radius-xl); overflow: hidden; box-shadow: var(--shadow-lg);">
                  <img id="previewImg" src="" alt="Preview" style="width: 100%; height: 200px; object-fit: cover;" />
                </div>
              </div>

              <!-- Title -->
              <div class="form-group">
                <label for="title" class="form-label">Title</label>
                <input type="text" class="form-input" id="title" name="title" placeholder="An amazing story title..."
                  required style="font-size: var(--text-xl); font-weight: 600;" />
              </div>

              <!-- Body -->
              <div class="form-group">
                <label for="body" class="form-label">Your Story</label>
                <textarea class="form-input form-textarea" id="body" name="body" placeholder="Once upon a time..."
                  required style="min-height: 250px; line-height: 1.8;"></textarea>
              </div>

              <!-- Actions -->
              <div style="display: flex; gap: var(--space-4); justify-content: flex-end; margin-top: var(--space-6);">
                <a href="/" class="btn btn-secondary">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                  Cancel
                </a>
                <button type="submit" class="btn btn-primary">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 19l9 2-9-18-9 18 9-2z"></path>
                  </svg>
                  Publish Story
                </button>
              </div>
            </form>
          </div>
        </div>
      </main>
  </div>

  <%- include("./partials/scripts") %>

    <!-- Image Preview Script -->
    <script>
      const fileInput = document.getElementById('coverImage');
      const fileUpload = document.getElementById('fileUpload');
      const imagePreview = document.getElementById('imagePreview');
      const previewImg = document.getElementById('previewImg');

      fileInput.addEventListener('change', function (e) {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function (e) {
            previewImg.src = e.target.result;
            imagePreview.style.display = 'block';
            fileUpload.style.borderColor = 'var(--color-accent)';
            fileUpload.style.background = 'var(--color-accent-light)';
          };
          reader.readAsDataURL(file);
        }
      });

      // Drag and drop visual feedback
      fileUpload.addEventListener('dragover', function (e) {
        e.preventDefault();
        this.style.borderColor = 'var(--color-accent)';
        this.style.background = 'var(--color-accent-light)';
      });

      fileUpload.addEventListener('dragleave', function (e) {
        e.preventDefault();
        if (!fileInput.files.length) {
          this.style.borderColor = '';
          this.style.background = '';
        }
      });

      // Auto-resize textarea
      const textarea = document.getElementById('body');
      textarea.addEventListener('input', function () {
        this.style.height = 'auto';
        this.style.height = Math.max(250, this.scrollHeight) + 'px';
      });
    </script>
</body>

</html>